machine:
  pre:
    - cd /opt/circleci/.pyenv && git pull && cd -
  python:
    version: 3.6.0b2
dependencies:
  pre:
    - pip install -U setuptools pip wheel
  override:
    - pip install -U -r requirements.txt
    - pip install -U 'flake8>=3.0.0,<4.0.0'
    - pip install -U 'mypy-lang>=0.4.0,<0.5.0'
    - pip install -U 'typed-ast>=0.6.0,<0.7.0'
    - wget -O vnu.zip https://github.com/validator/validator/releases/download/16.6.29/vnu.jar_16.6.29.zip
    - unzip vnu.zip
test:
  override:
    - flake8 run.py
    - mypy --silent-imports run.py
    - mypy advent
    - python run.py
    - java -jar dist/vnu.jar --verbose output/index.html
